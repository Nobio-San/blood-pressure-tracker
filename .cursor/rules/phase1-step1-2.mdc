```md
# ProjectRules.md（Cursor Project Rules 貼り付け用）

## 1. 目的とスコープ
- 目的: Phase 1（基礎版）の最初のユーザー接点として、血圧データを手動入力できる「入力フォームUI」を**モバイルファースト**で実装する。
- スコープ（本Stepで作る）:
  - 入力フォーム画面UI（家族メンバー選択、最高/最低血圧、脈拍、測定日時、記録/クリアボタン）
  - モバイルで見やすくタップしやすいスタイル（CSS）
  - 測定日時（`datetime-local`）のデフォルトを「現在日時」にする初期化
  - クリア（フォームリセット＋日時再セット＋フォーカス戻し）の最小挙動
- 非スコープ（本Stepではやらない）:
  - 保存処理（ローカル保存/サーバ送信）
  - 本格バリデーション（詳細なエラーメッセージ/ルール）
  - 家族メンバーのカスタマイズUI（当面固定）
  - iOS Safari向けの細かいフォーム見た目調整（必要なら後続Phaseで）

## 2. 技術スタック
- 使用言語: HTML / CSS / JavaScript（フレームワーク無し）
- 想定環境: Android Chrome（PWA想定）
- 依存/前提:
  - Step 1-1（`index.html` / `css/style.css` / `js/app.js` の雛形作成）が完了している前提
  - 画面文言は日本語、単位は `mmHg` / `bpm`

## 3. ディレクトリ/ファイル方針
- 主要ファイル:
  - `/index.html` : 画面構造（セマンティクス/アクセシビリティ優先）
  - `/css/style.css` : モバイルファーストのベース＋フォーム部品＋ボタン
  - `/js/app.js` : 初期化（日時セット）・クリア処理・イベント紐付け（最小限）
  - （任意）`/README.md` : UI仕様メモ（入力項目/レンジ/必須/文言/単位/簡易レイアウト）
- 読み込み順:
  - HTML → CSS → JS（`defer` で `app.js` を読み込む）
- DOM識別子の方針:
  - input/select/button には **一意の `id`** を付け、JSは `id` で取得する
  - `name` も合わせて付与し、将来の保存/送信（Step 1-3以降）に備える

## 4. コーディング規約（横断）
- 命名:
  - JavaScript: `lowerCamelCase`（例: `measuredAtInput`, `formatToDatetimeLocal`）
  - CSS: BEM（`block__elem--mod`）または Utility のどちらかに**統一**（このプロジェクトは原則BEM）
- コメント:
  - 原則日本語。関数の「入出力・副作用」を先頭1行で明記
- 構造:
  - 設定/定数・ドメイン（入力データ）・I/O（DOM操作）・UI更新を分離
- 禁止:
  - 魔法数の散在（範囲/ラベル/固定選択肢は1箇所に集約）
  - `outline: none;` でフォーカスを消す（focusは必ず可視化）

## 5. 実装ルール（プロジェクト固有）
### 5.1 フォーム項目（確定仕様）
- 家族メンバー（select・必須）:
  - 固定選択肢: `自分 / 配偶者 / 父 / 母`
  - `name="member"`、`id="member"`
- 最高血圧（number・必須）:
  - 範囲: **50–250**、`step=1`、`inputmode="numeric"`
  - `name="systolic"`、`id="systolic"`
  - 単位表示: `mmHg`
- 最低血圧（number・必須）:
  - 範囲: **30–150**、`step=1`、`inputmode="numeric"`
  - `name="diastolic"`、`id="diastolic"`
  - 単位表示: `mmHg`
- 脈拍（number・必須）:
  - 範囲: **40–200**、`step=1`、`inputmode="numeric"`
  - `name="pulse"`、`id="pulse"`
  - 単位表示: `bpm`
- 測定日時（`datetime-local`・必須）:
  - `name="measuredAt"`、`id="measuredAt"`
  - ヘルプテキスト: 「日付と時刻を選択」などを明示

### 5.2 HTML（セマンティクス/アクセシビリティ）
- ランドマーク: `header / main` を用い、フォームは `section` にまとめる
- 見出し: 画面タイトルは `h1`、セクションは `h2`
- `label[for]` と `input#id` を必ず紐付ける（ラベルタップでフォーカス）
- ヘルプ/エラー枠:
  - 各フィールドに `aria-describedby` でヘルプIDを紐付ける
  - 将来のエラー表示用に、各フィールド直下にメッセージ領域（空でOK）を用意

### 5.3 CSS（モバイルファースト）
- 可読性:
  - 基本フォントサイズ **16px以上**
  - 行間/余白スケールを定義（例: 8/12/16/24）
- タップ性:
  - input/select/button の最小高さ **44px相当以上**
  - フォーカスリング（`:focus-visible`）を明確に（コントラスト確保）
- レイアウト:
  - フォームは「カード」構造（背景/境界/角丸）
  - 最大幅を制限し中央寄せ（例: `max-width: 560px; margin: 0 auto;`）
  - 最高/最低血圧は同一行にまとめられる構造にし、狭幅は自動で縦積み
- ボタン:
  - Primary（記録する）/ Secondary（クリア）を**視覚的に明確**に
  - 誤タップ防止の間隔を確保（縦積み推奨、または十分なギャップ）
  - `:active` / `:disabled` / `:focus-visible` の状態を定義

### 5.4 JavaScript（最小挙動のみ）
- 初期化（ページ表示時）:
  - `measuredAt` が空の場合のみ、現在日時をセット
  - `datetime-local` 形式は **分まで（YYYY-MM-DDTHH:MM）** に整形し、ゼロ埋めを徹底
- クリアボタン:
  - クリックでフォームをリセット
  - リセット後に `measuredAt` を現在日時へ再セット
  - 操作後、先頭フィールド（推奨: `member` または `systolic`）へフォーカスを戻す
- 記録ボタン:
  - 本Stepでは保存しないため、`submit` の既定動作は抑止（後続Stepで実装予定）

## 6. UI/UX・入力操作の規約
- 入力順序（上→下）:
  - メンバー → 最高/最低血圧 → 脈拍 → 測定日時 → ボタン
- 入力しやすさ:
  - プレースホルダ/ヒントで範囲と単位を示す（例:「50〜250 mmHg」）
  - 数値入力は端末のテンキーが出る設定を優先（`type=number` + `inputmode=numeric`）
- 誤操作対策:
  - クリアはSecondaryとして控えめな見た目
  - ボタン間に十分な距離（視覚＋物理）を確保

## 7. パフォーマンス/品質
- 本StepはDOMベースのフォームのため、過剰な再描画やレイアウト計算を避ける
  - 初期化は `DOMContentLoaded` で1回
  - クリア時も必要最小限のDOM更新に留める
- CSS:
  - 影/アニメーションは控えめ、重いプロパティの多用を避ける
  - focusリングは軽量に（ボックスシャドウの過剰使用は避ける）

## 8. テスト/デバッグ（DoD）
- 表示/レイアウト:
  - 320px幅〜でフォームが崩れない（スクロールは許容）
  - 文字が小さすぎない（16px以上）
  - 入力部品/ボタンが44px相当以上でタップしやすい
- 入力体験:
  - 最高/最低血圧・脈拍・日時が入力しやすい（ラベル/ヒント/適切な入力タイプ）
  - 測定日時が初期表示で現在日時になっている
  - クリアで数値欄が空になり、日時は現在に戻る
- アクセシビリティ最低限:
  - ラベルタップで対応入力にフォーカス
  - Tab/Shift+Tabで自然な順序、フォーカス可視化がある
- ボタン:
  - 「記録する（Primary）」と「クリア（Secondary）」が視覚的に区別され、誤タップしにくい

## 9. リリース/更新運用
- `todo.md` / 計画md 更新時は、以下を本ルールへ差分反映する:
  - 入力項目（追加/削除）、数値レンジ、文言、ファイル構成、操作フロー
- 変更時は「画面スクショ（DevToolsでOK）」を残す（READMEまたはPRに添付）

## 10. 禁止事項/アンチパターン
- 指定なしで外部フレームワーク/大型ライブラリを導入しない
- `setInterval` でフォーム初期化を繰り返す等の乱用（初期化は1回）
- `outline: none;` でフォーカスを消す
- 範囲（min/max）や固定選択肢を複数箇所に重複定義

## 11. コミット/PR運用（任意）
- 1コミット=1意図（例: 「フォームHTML追加」「フォームCSS整備」「日時初期化」）
- メッセージは日本語で「要点 → 効果 → 影響範囲」を短く

---

### 付録A: 実装メモ（推奨パターン）
- JSは `init()` を用意し、`DOMContentLoaded` で1回だけ呼ぶ
- `formatToDatetimeLocal(date)` を作り、日時整形を1箇所に集約
- フィールドID（例）:
  - `member`, `systolic`, `diastolic`, `pulse`, `measuredAt`, `btnSubmit`, `btnClear`
```

```md
# 生成ログ（短い要約）
- 主要要件: 家族メンバー選択＋最高/最低血圧＋脈拍＋測定日時＋記録/クリアの入力フォームをモバイルファーストで実装。
- 数値レンジを明文化: 最高 50–250 / 最低 30–150 / 脈拍 40–200（全て必須）。
- UI品質: フォント16px以上、タップ領域44px相当以上、Primary/Secondaryボタンで誤タップを抑制。
- 最小JS: `datetime-local` の現在日時初期化（空のときのみ）＋クリアでリセット→日時再セット→フォーカス戻し。
- 非スコープ: 保存処理/本格バリデーション/家族メンバーのカスタマイズUI。
- TODO: 最小対応ブラウザ範囲（Chrome以外の優先度）と、家族メンバーの将来のカスタマイズ方法を後続Stepで確定。
```

